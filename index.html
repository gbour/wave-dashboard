
<html>
<head>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.0/jquery.min.js"></script>
    <script src="https://cdn.socket.io/socket.io-1.4.5.js"></script>
    <script src="https://rawgit.com/joewalnes/smoothie/master/smoothie.js"></script>
</head>
<body>

<h1>Erlang VM</h1>
<h2>Memory</h2>
<canvas id="memc" width="500" height="100"></canvas>

</body>
</html>

<script>
    var statsd = io('http://localhost:3001')
    statsd.on('timers', function(timers) {
        memDataSets[0].append(new Date().getTime(), timers.gauges['erlang.memory.processes']);
        memDataSets[1].append(new Date().getTime(), timers.gauges['erlang.memory.total']);
    });


    /** smoothie **/
    var seriesOptions = [
      { strokeStyle: 'rgba(255, 0, 0, 1)', fillStyle: 'rgba(255, 0, 0, 0.1)', lineWidth: 3 },
      { strokeStyle: 'rgba(0, 255, 0, 1)', fillStyle: 'rgba(0, 255, 0, 0.1)', lineWidth: 3 }
    ];
    var memDataSets = [new TimeSeries(), new TimeSeries()];

    var now = new Date().getTime();
    for (var t = now - 1000 * 50; t <= now; t += 1000) {
        memDataSets[0].append(t, 0);
        memDataSets[1].append(t, 0);
    }

    // Build the timeline
    var timeline = new SmoothieChart({ fps: 30, millisPerPixel: 20, grid: { strokeStyle: '#555555', lineWidth: 1, millisPerLine: 1000, verticalSections: 4}});
    for (var i = 0; i < memDataSets.length; i++) {
        timeline.addTimeSeries(memDataSets[i], seriesOptions[i]);
    }
    timeline.streamTo(document.getElementById('memc'), 1000);
</script>

